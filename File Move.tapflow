<RobotDefinition robotId="4600" robotName="File Move" editPoint="760,413" editZoom="0.659753955386447" Net.useLegacyV2RuntimeActivationPolicy="False">
  <externalLibraries />
  <controlIdentifiers />
  <variables>
    <variable name="pathList" type="System.Collections.Generic.List`1[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="pL" />
    <variable name="extensionList" type="System.Collections.Generic.List`1[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="eL" />
    <variable name="subPath" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="sP" />
    <variable name="createFoldersPerExtension" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="cFPE" />
    <variable name="destinationPath" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="dP" />
    <variable name="proceed" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <variable name="canProceed" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <variable name="totalFilesMoved" type="System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <variable name="givenPath" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <variable name="config" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <variable name="formattedExtensions" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
  </variables>
  <arguments>
    <argument name="pL" direction="Input" type="System.Collections.Generic.List`1[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <argument name="eL" direction="Input" type="System.Collections.Generic.List`1[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <argument name="sP" direction="Input" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <argument name="cFPE" direction="Input" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
    <argument name="dP" direction="Input" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" value="" />
  </arguments>
  <actions>
    <sequence id="2790" name="Auto Source" positionX="138" positionY="148" startNodePosition="50,25" fromConnector="c8" toConnector="c2" startPath="" breakpoint="False">
      <transitions>
        <transition id="4601" name="" condition="canProceed" type="Normal" sourceSequence="2790" targetSequence="757" fromConnector="c5" toConnector="c4" />
        <transition id="4602" name="" condition="!canProceed" type="Normal" sourceSequence="2790" targetSequence="2791" fromConnector="c7" toConnector="c4" />
      </transitions>
      <action id="2793" type="Custom.Code" displayName="C# Script" code="using System;&#xD;&#xA;using System.Windows;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Text;&#xD;&#xA;using System.Threading;&#xD;&#xA;using System.Net.Mail;&#xD;&#xA;using System.Drawing;&#xD;&#xA;using Tailent.Database;&#xD;&#xA;using System.Data;&#xD;&#xA;using HtmlAgilityPack;&#xD;&#xA;using Newtonsoft.Json.Linq;&#xD;&#xA;using MissionCritical.Automation.Excel;&#xD;&#xA;namespace MissionCritical.Automation.Scripting&#xD;&#xA;{&#xD;&#xA;    public static class CustomCode&#xD;&#xA;    {&#xD;&#xA;        public static void MainMethod()&#xD;&#xA;        {&#xD;&#xA;			canProceed = true;&#xD;&#xA;            if (!pL.Any()) canProceed = false;&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}" methodName="MainMethod" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="757" name="Move Confirm" positionX="794" positionY="100" breakpoint="False">
      <transitions>
        <transition id="4603" name="" condition="canProceed" type="Normal" sourceSequence="757" targetSequence="821" fromConnector="c5" toConnector="c4" />
        <transition id="4604" name="" condition="!canProceed" type="Normal" sourceSequence="757" targetSequence="2948" fromConnector="c8" toConnector="c4" />
      </transitions>
      <action id="806" type="User.Attended.UserInput" displayName="User Input Dialog" Message="&quot;Do you want to move the files now? Y/N&quot;" Title="&quot;File Mover&quot;" IsPassword="False" Output="proceed" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
      <action id="807" type="Custom.Code" displayName="C# Script" code="using System;&#xD;&#xA;using System.Windows;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Text;&#xD;&#xA;using System.Threading;&#xD;&#xA;using System.Net.Mail;&#xD;&#xA;using System.Drawing;&#xD;&#xA;using Tailent.Database;&#xD;&#xA;using System.Data;&#xD;&#xA;using HtmlAgilityPack;&#xD;&#xA;using Newtonsoft.Json.Linq;&#xD;&#xA;using MissionCritical.Automation.Excel;&#xD;&#xA;namespace MissionCritical.Automation.Scripting&#xD;&#xA;{&#xD;&#xA;    public static class CustomCode&#xD;&#xA;    {&#xD;&#xA;        public static void MainMethod()&#xD;&#xA;        {&#xD;&#xA;            canProceed = false;&#xD;&#xA;			if (string.IsNullOrEmpty(proceed) == false){&#xD;&#xA;		        proceed = proceed.ToLower();&#xD;&#xA;				canProceed = proceed.StartsWith(&quot;y&quot;) || proceed.StartsWith(&quot;da&quot;);&#xD;&#xA;			}&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}" methodName="MainMethod" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="821" name="Moving files" positionX="1205" positionY="45" breakpoint="False">
      <transitions />
      <action id="1081" type="Custom.Code" displayName="C# Script" code="using System;&#xD;&#xA;using System.IO;&#xD;&#xA;using System.Windows.Forms;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Text;&#xD;&#xA;using System.Threading;&#xD;&#xA;using System.Net.Mail;&#xD;&#xA;using System.Drawing;&#xD;&#xA;using Tailent.Database;&#xD;&#xA;using System.Data;&#xD;&#xA;using HtmlAgilityPack;&#xD;&#xA;using Newtonsoft.Json.Linq;&#xD;&#xA;using MissionCritical.Automation.Excel;&#xD;&#xA;&#xD;&#xA;namespace MissionCritical.Automation.Scripting&#xD;&#xA;{&#xD;&#xA;    public static class CustomCode&#xD;&#xA;    {&#xD;&#xA;        public static void MainMethod()&#xD;&#xA;        {&#xD;&#xA;            try&#xD;&#xA;            {&#xD;&#xA;                bool anyFolderCreated = false;&#xD;&#xA;                totalFilesMoved = 0;&#xD;&#xA;&#xD;&#xA;                // Create destination directory if it doesn't exist&#xD;&#xA;                Directory.CreateDirectory(destinationPath);&#xD;&#xA;&#xD;&#xA;                foreach (string sourcePath in pathList)&#xD;&#xA;                {&#xD;&#xA;                    if (!Directory.Exists(sourcePath))&#xD;&#xA;                    {&#xD;&#xA;                        Console.WriteLine($&quot;Source path does not exist: {sourcePath}&quot;);&#xD;&#xA;                        continue;&#xD;&#xA;                    }&#xD;&#xA;&#xD;&#xA;                    foreach (string extension in extensionList)&#xD;&#xA;                    {&#xD;&#xA;                        // Get files with current extension&#xD;&#xA;                        string searchPattern = &quot;*&quot; + extension;&#xD;&#xA;                        SearchOption searchOption = subPath ? SearchOption.AllDirectories : SearchOption.TopDirectoryOnly;&#xD;&#xA;                        &#xD;&#xA;                        string[] files;&#xD;&#xA;                        try&#xD;&#xA;                        {&#xD;&#xA;                            files = Directory.GetFiles(sourcePath, searchPattern, searchOption);&#xD;&#xA;                        }&#xD;&#xA;                        catch (UnauthorizedAccessException)&#xD;&#xA;                        {&#xD;&#xA;                            Console.WriteLine($&quot;No access to some directories in: {sourcePath}&quot;);&#xD;&#xA;                            continue;&#xD;&#xA;                        }&#xD;&#xA;&#xD;&#xA;                        if (files.Length &gt; 0)&#xD;&#xA;                        {&#xD;&#xA;                            string folderPath = destinationPath;&#xD;&#xA;                            &#xD;&#xA;                            if (createFoldersPerExtension)&#xD;&#xA;                            {&#xD;&#xA;                                // Create folder with extension name (without dot)&#xD;&#xA;                                string folderName = extension.TrimStart('.').ToUpper() + &quot;_Files&quot;;&#xD;&#xA;                                folderPath = Path.Combine(destinationPath, folderName);&#xD;&#xA;                                Directory.CreateDirectory(folderPath);&#xD;&#xA;                                anyFolderCreated = true;&#xD;&#xA;                            }&#xD;&#xA;&#xD;&#xA;                            // Move all files to corresponding folder&#xD;&#xA;                            foreach (string file in files)&#xD;&#xA;                            {&#xD;&#xA;                                try&#xD;&#xA;                                {&#xD;&#xA;                                    string fileName = Path.GetFileName(file);&#xD;&#xA;                                    string destFile = Path.Combine(folderPath, fileName);&#xD;&#xA;                                    &#xD;&#xA;                                    // Check if file already exists in destination&#xD;&#xA;                                    if (!File.Exists(destFile))&#xD;&#xA;                                    {&#xD;&#xA;                                        File.Move(file, destFile);&#xD;&#xA;                                        totalFilesMoved++;&#xD;&#xA;                                    }&#xD;&#xA;                                    else&#xD;&#xA;                                    {&#xD;&#xA;                                        // Add timestamp to avoid overwriting&#xD;&#xA;                                        string timestamp = DateTime.Now.ToString(&quot;yyyyMMddHHmmss&quot;);&#xD;&#xA;                                        string newFileName = $&quot;{Path.GetFileNameWithoutExtension(fileName)}_{timestamp}{Path.GetExtension(fileName)}&quot;;&#xD;&#xA;                                        File.Move(file, Path.Combine(folderPath, newFileName));&#xD;&#xA;                                        totalFilesMoved++;&#xD;&#xA;                                    }&#xD;&#xA;                                }&#xD;&#xA;                                catch (IOException ioEx)&#xD;&#xA;                                {&#xD;&#xA;                                    Console.WriteLine($&quot;Error moving file {file}: {ioEx.Message}&quot;);&#xD;&#xA;                                }&#xD;&#xA;                            }&#xD;&#xA;                            &#xD;&#xA;                            Console.WriteLine($&quot;Moved {files.Length} {extension} files to {folderPath}&quot;);&#xD;&#xA;                        }&#xD;&#xA;                    }&#xD;&#xA;                }&#xD;&#xA;&#xD;&#xA;                if (anyFolderCreated || totalFilesMoved &gt; 0)&#xD;&#xA;                {&#xD;&#xA;                    MessageBox.Show($&quot;Operation completed!\nMoved {totalFilesMoved} files to their respective folders.&quot;, &quot;Success&quot;, MessageBoxButtons.OK, MessageBoxIcon.Information);&#xD;&#xA;                }&#xD;&#xA;                else&#xD;&#xA;                {&#xD;&#xA;                    MessageBox.Show(&quot;No files with the specified extensions were found.&quot;, &quot;Information&quot;, MessageBoxButtons.OK, MessageBoxIcon.Information);&#xD;&#xA;                }&#xD;&#xA;            }&#xD;&#xA;            catch (Exception ex)&#xD;&#xA;            {&#xD;&#xA;                MessageBox.Show($&quot;An error occurred: {ex.Message}&quot;, &quot;Error&quot;, MessageBoxButtons.OK, MessageBoxIcon.Error);&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}" methodName="MainMethod" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
      <action id="808" type="Flow.MessageBox" displayName="Show Message Box" output="totalFilesMoved + &quot; files SUCSESSFULLY moved!&quot;" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="2791" name="Select configuration" positionX="441" positionY="255" breakpoint="False">
      <transitions>
        <transition id="4605" name="" condition="true" type="Normal" sourceSequence="2791" targetSequence="3031" fromConnector="c6" toConnector="c1" />
      </transitions>
      <action id="3030" type="Flow.MessageBox" displayName="Show Message Box" output="&quot;No current wizzard configuration detected, please choose a configuration file.&quot;" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
      <action id="3216" type="User.Attended.ChooseFile" Filter="&quot;All Files|*.*&quot;" Output="givenPath" displayName="Choose File" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="2948" name="Setup Canceled" positionX="1202" positionY="217" breakpoint="False">
      <transitions />
      <action id="2273" type="Flow.MessageBox" displayName="Show Message Box" output="&quot;Setup canceled by user!&quot;" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="3031" name="Verify path" positionX="441" positionY="463" breakpoint="False">
      <transitions>
        <transition id="4606" name="" condition="!canProceed" type="Normal" sourceSequence="3031" targetSequence="2791" fromConnector="c3" toConnector="c8" />
        <transition id="4607" name="" condition="canProceed" type="Normal" sourceSequence="3031" targetSequence="3215" fromConnector="c5" toConnector="c4" />
      </transitions>
      <action id="3037" type="Custom.Code" displayName="C# Script" code="using System;&#xD;&#xA;using System.Windows;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Text;&#xD;&#xA;using System.Threading;&#xD;&#xA;using System.Net.Mail;&#xD;&#xA;using System.Drawing;&#xD;&#xA;using Tailent.Database;&#xD;&#xA;using System.Data;&#xD;&#xA;using HtmlAgilityPack;&#xD;&#xA;using Newtonsoft.Json.Linq;&#xD;&#xA;using MissionCritical.Automation.Excel;&#xD;&#xA;namespace MissionCritical.Automation.Scripting&#xD;&#xA;{&#xD;&#xA;    public static class CustomCode&#xD;&#xA;    {&#xD;&#xA;        public static void MainMethod()&#xD;&#xA;        {&#xD;&#xA;			canProceed = true;&#xD;&#xA;			if(string.IsNullOrEmpty(givenPath)){&#xD;&#xA;				MessageBox.Show(&quot;Given folder path inaccessible, already selected or empty!&quot;);&#xD;&#xA;				canProceed = false;&#xD;&#xA;			}&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}" methodName="MainMethod" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
    <sequence id="3215" name="Import Configuration" positionX="794" positionY="359" breakpoint="False">
      <transitions>
        <transition id="4608" name="" condition="true" type="Normal" sourceSequence="3215" targetSequence="757" fromConnector="c2" toConnector="c7" />
      </transitions>
      <action id="3550" type="IO.ReadText" path="givenPath" output="config" displayName="Read Text File" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
      <action id="3217" type="Custom.Code" displayName="C# Script" code="using System;&#xD;&#xA;using System.Windows;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Text;&#xD;&#xA;using System.Threading;&#xD;&#xA;using System.Net.Mail;&#xD;&#xA;using System.Drawing;&#xD;&#xA;using Tailent.Database;&#xD;&#xA;using System.Data;&#xD;&#xA;using HtmlAgilityPack;&#xD;&#xA;using Newtonsoft.Json.Linq;&#xD;&#xA;using MissionCritical.Automation.Excel;&#xD;&#xA;namespace MissionCritical.Automation.Scripting&#xD;&#xA;{&#xD;&#xA;    public static class CustomCode&#xD;&#xA;    {&#xD;&#xA;        public static void MainMethod()&#xD;&#xA;        {&#xD;&#xA;			int pos = 0;&#xD;&#xA;			while (pos &lt; config.Length)&#xD;&#xA;			{&#xD;&#xA;			    // Find next line break&#xD;&#xA;			    int endLine = config.IndexOf('\n', pos);&#xD;&#xA;			    if (endLine == -1) endLine = config.Length;&#xD;&#xA;			    &#xD;&#xA;			    // Get current line&#xD;&#xA;			    string line = config.Substring(pos, endLine - pos);&#xD;&#xA;			    pos = endLine + 1;&#xD;&#xA;			    &#xD;&#xA;			    // Split key/value&#xD;&#xA;			    int eqPos = line.IndexOf('=');&#xD;&#xA;			    if (eqPos &lt;= 0) continue;&#xD;&#xA;			    &#xD;&#xA;			    string key = line.Substring(0, eqPos);&#xD;&#xA;			    string value = line.Substring(eqPos + 1);&#xD;&#xA;			    &#xD;&#xA;			    // Set variables&#xD;&#xA;			    switch (key)&#xD;&#xA;			    {&#xD;&#xA;			        case &quot;pathList&quot;:&#xD;&#xA;			            pathList = new List&lt;string&gt;(value.Split(';'));&#xD;&#xA;			            break;&#xD;&#xA;			            &#xD;&#xA;			        case &quot;extensionList&quot;:&#xD;&#xA;			            extensionList = new List&lt;string&gt;(value.Split(';'));&#xD;&#xA;			            break;&#xD;&#xA;			            &#xD;&#xA;			        case &quot;subPath&quot;:&#xD;&#xA;			            subPath = value.Equals(&quot;true&quot;, StringComparison.OrdinalIgnoreCase);&#xD;&#xA;			            break;&#xD;&#xA;			            &#xD;&#xA;			        case &quot;createFoldersPerExtension&quot;:&#xD;&#xA;			            createFoldersPerExtension = value.Equals(&quot;true&quot;, StringComparison.OrdinalIgnoreCase);&#xD;&#xA;			            break;&#xD;&#xA;			            &#xD;&#xA;			        case &quot;destinationPath&quot;:&#xD;&#xA;			            destinationPath = value;&#xD;&#xA;			            break;&#xD;&#xA;			    }&#xD;&#xA;			}&#xD;&#xA;			formattedExtensions = string.Join(&quot;, &quot;,&#xD;&#xA;                extensionList.Select((ext, index) =&gt; &#xD;&#xA;                    (index + 1) % 12 == 0 ? ext + &quot;\n&quot; : ext));&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}" methodName="MainMethod" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
      <action id="3218" type="Flow.MessageBox" displayName="Show Message Box" output="&quot;Data SUCCESFULLY retrieved\n&quot; + &quot;Configuration Summary: \n&quot; + &quot;Path List: &quot; + string.Join(&quot;, &quot;, pathList) + &quot;\n&quot; +&quot;Extension List: &quot; + formattedExtensions + &quot;\n&quot; +&quot;Destination: &quot; + destinationPath + &quot;\n&quot; +&quot;Search Subfolders: &quot; + (subPath? &quot;Yes&quot; : &quot;No&quot;) + &quot;\n&quot; +&quot;Create Extension Folders: &quot; + (createFoldersPerExtension? &quot;Yes&quot; : &quot;No&quot;)" waitBefore="150" waitAfter="150" abortOnError="True" retryTimes="0" breakpoint="False" />
    </sequence>
  </actions>
</RobotDefinition>